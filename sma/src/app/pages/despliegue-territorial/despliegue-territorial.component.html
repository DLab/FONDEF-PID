<div class="page" fxLayout="column">

    <fury-breadcrumbs class="breadcrumbs" 
           *ngIf="app.selectedMenuItem != null"
           [crumbs]="app.selectedMenuItem.lang_crumbs" 
           current="{{app.screen[app.selectedMenuItem.name]}}" >
    </fury-breadcrumbs>
  
    <mat-expansion-panel expanded="true" (opened)="filterOpenState = true" (closed)="filterOpenState = false" >
        <mat-expansion-panel-header>
          <mat-panel-title class="title" [style.padding-top]="filterOpenState ? '0px': '7px'">
            {{app.screen.Filtros}}
          </mat-panel-title>
          <button (click)="search();$event.stopPropagation()" type="button" mat-icon-button color="primary" *ngIf="!filterOpenState">
            <mat-icon>rotate_right</mat-icon>
          </button>        
        </mat-expansion-panel-header>
      
        <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap.gt-sm="16px" fxLayoutAlign="start end" [style.width]="'100%'">
          <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap.gt-sm="24px" [style.width]="'100%'">
            <form [formGroup]="form" class="person">
              <mat-dialog-content>
                <div class="person">
                  <div fxLayout="row" fxLayoutGap.gt-sm="24px" >        
    
                    <mat-form-field fxFlex="20">
                      <mat-label>{{app.screen.BaseDato}}</mat-label>
                      <input matInput [matAutocomplete]="baseDato" formControlName="baseDato" required>
                      <mat-autocomplete #baseDato="matAutocomplete" [displayWith]="filterBaseDato.displayItem" (optionSelected)="changeBaseDato()">
                        <mat-option *ngFor="let item of filterBaseDato.filteredItems| async" [value]="item">
                          <span>{{ item.descripcion }}</span>
                        </mat-option>
                      </mat-autocomplete>
                      <button *ngIf="form.get('baseDato').value != null" type="button" mat-icon-button (click)="form.get('baseDato').reset()" matSuffix>
                        <mat-icon>close</mat-icon>
                      </button>
                      <button *ngIf="form.get('baseDato').value == null" type="button" mat-icon-button matSuffix>
                        <mat-icon>arrow_drop_down</mat-icon>
                      </button>
                    </mat-form-field>
     
                    <mat-form-field fxFlex="20">
                      <mat-label>{{app.screen.Tipo_Dato}}</mat-label>
                      <input matInput [matAutocomplete]="tipoDato" formControlName="tipoDato" required>
                      <mat-autocomplete #tipoDato="matAutocomplete" [displayWith]="filterTipoDato.displayItem">
                        <mat-option *ngFor="let item of filterTipoDato.filteredItems| async" [value]="item">
                          <span>{{ item.descripcion }}</span>
                        </mat-option>
                      </mat-autocomplete>
                      <button *ngIf="form.get('tipoDato').value != null" type="button" mat-icon-button (click)="form.get('tipoDato').reset()" matSuffix>
                        <mat-icon>close</mat-icon>
                      </button>
                      <button *ngIf="form.get('tipoDato').value == null" type="button" mat-icon-button matSuffix>
                        <mat-icon>arrow_drop_down</mat-icon>
                      </button>
                    </mat-form-field>
                    
                    <mat-form-field fxFlex="20">
                      <mat-label>{{app.screen.Fuente_de_datos}}</mat-label>
                      <input matInput [matAutocomplete]="fuente" formControlName="fuente" required>
                      <mat-autocomplete #fuente="matAutocomplete" [displayWith]="filterFuenteDato.displayItem">
                        <mat-option *ngFor="let item of filterFuenteDato.filteredItems| async" [value]="item">
                          <span>{{ item.descripcion }}</span>
                        </mat-option>
                      </mat-autocomplete>
                      <button *ngIf="form.get('fuente').value != null" type="button" mat-icon-button (click)="form.get('fuente').reset()" matSuffix>
                        <mat-icon>close</mat-icon>
                      </button>
                      <button *ngIf="form.get('fuente').value == null" type="button" mat-icon-button matSuffix>
                        <mat-icon>arrow_drop_down</mat-icon>
                      </button>
                    </mat-form-field>
      
                    <mat-form-field fxFlex="20">
                      <mat-label>{{app.screen.Fecha_Inicio}}</mat-label>
                      <input matInput [ngxMatDatetimePicker]="inicio" placeholder="{{app.screen.Elija_una_fecha}}" formControlName="inicio" >
                      <mat-datepicker-toggle matSuffix [for]="inicio"></mat-datepicker-toggle>
                      <ngx-mat-datetime-picker #inicio
                          [showSpinners]="true"
                          [showSeconds]="true"
                          [stepMinute]="5"
                          [touchUi]="true">
                          <ng-template>
                            <!-- <mat-icon>star</mat-icon> -->
                            <span>{{app.screen.Aceptar}}</span>
                          </ng-template>
                      </ngx-mat-datetime-picker>
                    </mat-form-field>
        
                    <mat-form-field fxFlex="20">
                      <mat-label>{{app.screen.Fecha_Termino}}</mat-label>
                      <input matInput [ngxMatDatetimePicker]="termino" placeholder="{{app.screen.Elija_una_fecha}}" formControlName="termino" >
                      <mat-datepicker-toggle matSuffix [for]="termino"></mat-datepicker-toggle>
                      <ngx-mat-datetime-picker #termino
                          [showSpinners]="true"
                          [showSeconds]="true"
                          [stepMinute]="5"
                          [touchUi]="true">
                          <ng-template>
                            <!-- <mat-icon>star</mat-icon> -->
                            <span>{{app.screen.Aceptar}}</span>
                          </ng-template>
                      </ngx-mat-datetime-picker>
                    </mat-form-field>   
                                        
                  </div>
    
        
                </div>
              </mat-dialog-content>
            </form>
          </div>
          <div class="actions">
            <button class="create" (click)="search()" type="button" mat-mini-fab color="primary" [disabled]="!isValid()">
              <mat-icon>rotate_right</mat-icon>
            </button>
          </div>
        </div>
      </mat-expansion-panel>
    
    <div style="height: 760px;"
       leaflet 
      [leafletOptions]="options"
      [leafletLayers]="layers">
    </div>
    

</div>