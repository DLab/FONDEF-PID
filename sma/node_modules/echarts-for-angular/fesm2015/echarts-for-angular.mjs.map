{"version":3,"file":"echarts-for-angular.mjs","sources":["../../../projects/echartsx/src/lib/internal/HtmlHelper.ts","../../../projects/echartsx/src/lib/driective/EchartsDirective.ts","../../../projects/echartsx/src/lib/echartsx-module.ts","../../../projects/echartsx/src/public-api.ts","../../../projects/echartsx/src/echarts-for-angular.ts"],"sourcesContent":["import { Observable, interval } from 'rxjs';\r\nimport { filter, map } from 'rxjs/operators';\r\n\r\nexport class HtmlHelper {\r\n\r\n    static elementIsFocusable(ele: HTMLElement): boolean {\r\n        return ele.getAttribute(\"tabindex\") != null;\r\n    }\r\n\r\n    static getWidthSensor(\r\n        element: HTMLElement,\r\n        periodicityInMiliSeconds: number = 2000\r\n    ): Observable<number> {\r\n        let oldWidth = element.clientWidth;\r\n        return interval(periodicityInMiliSeconds).pipe(\r\n            filter(\r\n                ignore => {\r\n                    if (Math.abs(oldWidth - element.clientWidth) > 2) {\r\n                        oldWidth = element.clientWidth;\r\n                        return true;\r\n                    }\r\n                    return false;\r\n                }\r\n            ),\r\n            map(\r\n                ignore => element.clientWidth\r\n            )\r\n        );\r\n    }\r\n\r\n    static getHeightSensor(\r\n        element: HTMLElement,\r\n        periodicityInMiliSeconds: number = 2000\r\n    ): Observable<number> {\r\n        let oldHeight = element.clientHeight;\r\n        return interval(periodicityInMiliSeconds).pipe(\r\n            filter(\r\n                ignore => {\r\n                    if (Math.abs(oldHeight - element.clientHeight) > 2) {\r\n                        oldHeight = element.clientHeight;\r\n                        return true;\r\n                    }\r\n                    return false;\r\n                }\r\n            ),\r\n            map(\r\n                ignore => element.clientWidth\r\n            )\r\n        );\r\n    }\r\n}","import { Directive, ElementRef, EventEmitter, Input, OnChanges, OnDestroy, OnInit, Output, SimpleChanges } from \"@angular/core\";\r\nimport { Subscription } from \"rxjs\";\r\n\r\nimport * as echarts from 'echarts/core';\r\nimport { CanvasRenderer } from 'echarts/renderers';\r\nimport { HtmlHelper } from \"../internal/HtmlHelper\";\r\nimport { EChartsOption } from 'echarts';\r\n\r\n\r\n@Directive({\r\n    selector: \"[echarts]\"\r\n})\r\n\r\nexport class EchartsDirective implements OnInit, OnDestroy, OnChanges {\r\n    @Input() options: EChartsOption | undefined;\r\n    @Input() extentions: any[] = [];\r\n    @Input() isResizable: boolean = true;\r\n    @Input() defaultWidth: number = 400;\r\n    @Input() defaultHeight: number = 400;\r\n    @Input() periodicityInMiliSeconds: number = 2000;\r\n    @Input() theme: Object | string = '';\r\n\r\n    @Output() chartInit = new EventEmitter<echarts.ECharts>();\r\n\r\n    private _echartsInstance: echarts.ECharts | undefined;\r\n\r\n    private _subscription: Subscription | undefined;\r\n\r\n    constructor (\r\n        private readonly _el: ElementRef<HTMLElement>\r\n    ) { }\r\n\r\n    ngOnInit(): void {\r\n        echarts.use([...this.extentions, CanvasRenderer]);\r\n        this._echartsInstance = echarts.init(this._el.nativeElement, this.theme, {\r\n            width: this._el.nativeElement.clientWidth === this.defaultWidth ? 400 : undefined,\r\n            height: this._el.nativeElement.clientHeight === 0 ? this.defaultHeight : undefined\r\n        });\r\n        this.chartInit.emit(this._echartsInstance);\r\n        this._setParams();\r\n        if (this.isResizable) {\r\n            this._addResizbleFunctionality();\r\n        }\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        if (changes.options && !changes.options.firstChange) {\r\n            this._setParams();\r\n        }\r\n\r\n        if (changes.isResizable && !changes.isResizable.firstChange) {\r\n            if (this.isResizable) {\r\n                this._addResizbleFunctionality();\r\n            } else {\r\n                if (this._subscription != null) this._subscription.unsubscribe();\r\n            }\r\n        }\r\n    }\r\n\r\n    private _addResizbleFunctionality() {\r\n        if (this._subscription != null) this._subscription.unsubscribe();\r\n        this._subscription = HtmlHelper.getWidthSensor(this._el.nativeElement).subscribe(() => {\r\n            if (this._echartsInstance != null) {\r\n                this._echartsInstance.resize();\r\n            }\r\n        });\r\n    }\r\n    private _setParams() {\r\n        if (this._echartsInstance != null && this.options != null) {\r\n            this._echartsInstance.setOption(this.options, true);\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this._subscription != null) this._subscription.unsubscribe();\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { EchartsDirective } from './driective/EchartsDirective';\r\n\r\n\r\n@NgModule({\r\n    declarations: [EchartsDirective],\r\n    exports: [EchartsDirective]\r\n})\r\nexport class EchartsxModule { }\r\n","/*\r\n * Public API Surface of echartsx\r\n */\r\n\r\nexport * from './lib/echartsx-module';\r\nexport {EchartsDirective} from './lib/driective/EchartsDirective'","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}